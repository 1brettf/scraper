from flask import Flask, render_template, request, send_file, session, redirect, jsonify, Response
from _thread import start_new_thread
from scraper import start_scraper
import json
import os
import hashlib
import pickle

app = Flask(__name__)


@app.route('/', methods=["GET"])
def index():
    return '--MAIN WEBSITE HTML GOES HERE--'


@app.route("/post", methods=["POST"])
def post():
    userid = get_uuid(request)
    json_data = request.get_json()
    if type(json_data) != dict or "request_type" not in json_data:
        return Response(json.dumps({'Error': 'Bad Request'}), status=400, mimetype='application/json')
    elif json_data["request_type"] == "feed":
        if os.path.isfile("news_collated.data"):
            return Response(json.dumps(pickle.load(open("news_collated.data", "rb"))), status=200, mimetype='application/json')
        else:
            return Response(json.dumps([]), status=200, mimetype='application/json')
    elif json_data["request_type"] == "uuid":
        return Response(json.dumps({"uuid": userid}), status=200, mimetype='application/json')
    elif json_data["request_type"] == "like":
        if "liked" not in json_data or json_data["liked"] not in (True, False) or "url" not in json_data:
            return Response(json.dumps({'Error': 'Bad Request'}), status=400, mimetype='application/json')
        else:
            if not os.path.isfile("users.data"):
                pickle.dump({}, open("users.data", "wb"))
            userdata = pickle.load(open("users.data", "rb"))
            if userid not in userdata:
                userdata[userid] = {"liked": [], "notliked": [], "tags": {}}
            if json_data["liked"] == True:
                userdata[userid]["liked"] = list(set(userdata[userid]["liked"].append(json_data["url"])))
            elif json_data["liked"] == False:
                userdata[userid]["notliked"] = list(set(userdata[userid]["notliked"].append(json_data["url"])))
            pickle.dump(userdata, open("users.data", "wb"))
    elif json_data["request_type"] == "tag":
        if "tag" not in json_data or type(json_data["tag"]) != dict:
            return Response(json.dumps({'Error': 'Bad Request'}), status=400, mimetype='application/json')
        if not os.path.isfile("users.data"):
            pickle.dump({}, open("users.data", "wb"))
        userdata = pickle.load(open("users.data", "rb"))
        if userid not in userdata:
            userdata[userid] = {"liked": [], "notliked": [], "tags": {}}
        if
    else:
        return Response(json.dumps({'Error': 'Bad Request'}), status=400, mimetype='application/json')


"""
POST JSON to /post endpoint
Example:
POSTed JSON                 ->    response JSON
{"request_type": "uuid"}    ->    {"uuid": "f16aac323c5e63f91b8b21c2764ef5bc"}
{"request_type": "feed"}-> [{"title": "Coronavirus: New restrictions in north-east England", "description": "Measures to stop households mixing and early pub closures will come into effect from midnight.", "link": "https://www.bbc.co.uk/news/uk-england-tyne-54188766", "published": "Thu, 17 Sep 2020 12:41:56 GMT", "source": "BBC News - England"}, {"title": "Coronavirus: Test turnaround times getting longer in England", "description": "Only 1 in 3 tests carried out in community testing centres in England are processed within 24 hours.", "link": "https://www.bbc.co.uk/news/health-54191745", "published": "Thu, 17 Sep 2020 11:27:31 GMT", "source": "BBC News - England"}, {"title": "Edward Colston statue: Cases sent to Crown Prosecution Service", "description": "Protesters in Bristol pulled down a statue of Edward Colston and pushed it into the harbour in June.", "link": "https://www.bbc.co.uk/news/uk-england-bristol-54191039", "published": "Thu, 17 Sep 2020 11:23:09 GMT", "source": "BBC News - England"}, {"title": "Rail replacement services 'humiliating' disabled people", "description": "Rules on accessible buses come into force at the end of year but operators say there are not enough.", "link": "https://www.bbc.co.uk/news/uk-england-53905214", "published": "Thu, 17 Sep 2020 10:25:29 GMT", "source": "BBC News - England"}, {"title": "Pinewood Studios to create film-inspired visitor attraction", "description": "The world famous film complex says it is the \"right moment\" to plan for a visitor experience.", "link": "https://www.bbc.co.uk/news/uk-england-beds-bucks-herts-54190414", "published": "Thu, 17 Sep 2020 12:32:35 GMT", "source": "BBC News - England"}, {"title": "Coronavirus: Return of hospital parking charges 'utter disgrace'", "description": "A union blasts a decision to restore charges for staff while coronavirus \"is still being fought\".", "link": "https://www.bbc.co.uk/news/uk-england-york-north-yorkshire-54192516", "published": "Thu, 17 Sep 2020 12:48:22 GMT", "source": "BBC News - England"}, {"title": "Cornwall lithium deposits 'globally significant'", "description": "Cornish Lithium has been testing grades of the metal in deep geothermal waters near Redruth.", "link": "https://www.bbc.co.uk/news/uk-england-cornwall-54188071", "published": "Thu, 17 Sep 2020 09:13:28 GMT", "source": "BBC News - England"}, {"title": "September is record month for migrant Channel crossings", "description": "The first 16 days of September saw 1,487 people cross the Channel, more than any other month.", "link": "https://www.bbc.co.uk/news/uk-england-kent-54188041", "published": "Thu, 17 Sep 2020 09:30:12 GMT", "source": "BBC News - England"}, {"title": "Steven Clark murder: Appeal for letter writer to come forward", "description": "Police want whoever wrote to them seven years after Steven Clark's disappearance to come forward.", "link": "https://www.bbc.co.uk/news/uk-england-tees-54189351", "published": "Thu, 17 Sep 2020 10:53:50 GMT", "source": "BBC News - England"}, {"title": "Capt Sir Tom Moore helps those with 'difficulties'", "description": "The war veteran launches his charitable foundation inspired by his wife's mental health problems.", "link": "https://www.bbc.co.uk/news/uk-england-beds-bucks-herts-54187945", "published": "Thu, 17 Sep 2020 12:21:14 GMT", "source": "BBC News - England"}, {"title": "Surgeries at face-to-face capacity, GP body warns", "description": "The Royal College of GPs said an NHS reminder to offer in-person appointments was \"frankly silly\".", "link": "https://www.bbc.co.uk/news/uk-england-54180359", "published": "Wed, 16 Sep 2020 23:26:37 GMT", "source": "BBC News - England"}, {"title": "Airwoman Rita Ellis 1967 murder: Crimewatch appeal turns up 'new reports'", "description": "The killing and sexual assault of a 19-year-old RAF servicewoman featured on BBC Crimewatch.", "link": "https://www.bbc.co.uk/news/uk-england-beds-bucks-herts-54178448", "published": "Wed, 16 Sep 2020 23:25:37 GMT", "source": "BBC News - England"}, {"title": "Coronavirus: 'Why can I meet my mum in a pub but not her home?'", "description": "We look at the extra restrictions imposed in parts of the West Midlands - and the reasons for them.", "link": "https://www.bbc.co.uk/news/uk-england-birmingham-54175235", "published": "Wed, 16 Sep 2020 23:25:48 GMT", "source": "BBC News - England"}, {"title": "Coronavirus: What are social distancing and self-isolation rules?", "description": "Coronavirus cases are increasing, so what are the rules on social distancing?", "link": "https://www.bbc.co.uk/news/uk-51506729", "published": "Tue, 15 Sep 2020 16:21:37 GMT", "source": "BBC News - England"}, {"title": "Coronavirus: Behind the rise in cases in five charts", "description": "Extra testing targeting areas with high infection rates and changes to eligibility are both factors.", "link": "https://www.bbc.co.uk/news/health-54064347", "published": "Wed, 09 Sep 2020 17:01:59 GMT", "source": "BBC News - England"}, {"title": "Coronavirus: Which areas are under lockdown and what are the rules?", "description": "North-east areas such as Newcastle are the latest to face extra restrictions as coronavirus rates rise.", "link": "https://www.bbc.co.uk/news/uk-england-52934822", "published": "Thu, 17 Sep 2020 11:27:23 GMT", "source": "BBC News - England"}, {"title": "Coronavirus in the UK: How many confirmed cases are there in your area?", "description": "Explore the data on coronavirus in the UK and find out how many cases there are in your area.", "link": "https://www.bbc.co.uk/news/uk-51768274", "published": "Wed, 16 Sep 2020 16:32:51 GMT", "source": "BBC News - England"}, {"title": "Coronavirus: What are the UK travel quarantine rules?", "description": "Travellers arriving from places like France and Spain must follow certain rules on entry to the UK.", "link": "https://www.bbc.co.uk/news/explainers-52544307", "published": "Thu, 10 Sep 2020 16:35:41 GMT", "source": "BBC News - England"}, {"title": "Coronavirus: \u2018It\u2019s unfair to blame young people for virus rise\u2019", "description": "Radio 1 Newsbeat speaks to young people after the health secretary's \"don't kill your gran\" warning.", "link": "https://www.bbc.co.uk/news/newsbeat-54076937", "published": "Tue, 08 Sep 2020 15:57:00 GMT", "source": "BBC News - England"}, {"title": "Coronavirus: What happens if I'm in an area on the watchlist?", "description": "How health bosses decide whether a town should go back into lockdown if Covid-19 cases rise.", "link": "https://www.bbc.co.uk/news/uk-england-53582393", "published": "Sat, 01 Aug 2020 23:46:04 GMT", "source": "BBC News - England"}, {"title": "Should office workers be heading back in?", "description": "Business leaders in Ipswich say they need people back working in the town to help the economy.", "link": "https://www.bbc.co.uk/news/uk-england-suffolk-53888733", "published": "Tue, 25 Aug 2020 10:33:24 GMT", "source": "BBC News - England"}, {"title": "Coronavirus: What does my boss have to do to keep me safe?", "description": "The government wants more people to return to the workplace - but what precautions must employers take?", "link": "https://www.bbc.co.uk/news/business-52567567", "published": "Fri, 28 Aug 2020 12:22:39 GMT", "source": "BBC News - England"}, {"title": "Coronavirus: What are the rules for face masks or face coverings?", "description": "The guidance on who should wear face coverings varies around the UK.", "link": "https://www.bbc.co.uk/news/health-51205344", "published": "Fri, 11 Sep 2020 07:54:09 GMT", "source": "BBC News - England"}, {"title": "Couple call for routine group B strep screening for mums", "description": "A couple from Berkshire whose baby was stillborn are calling for pregnant women to be screened.", "link": "https://www.bbc.co.uk/news/uk-england-berkshire-54175157", "published": "Wed, 16 Sep 2020 23:22:55 GMT", "source": "BBC News - England"}, {"title": "Cyclist's wheelchair challenge after learning to walk again", "description": "A man who broke his back during a charity cycle ride turns fundraiser again after learning to walk.", "link": "https://www.bbc.co.uk/news/uk-england-stoke-staffordshire-54181838", "published": "Wed, 16 Sep 2020 16:47:37 GMT", "source": "BBC News - England"}, {"title": "Portsmouth children's entertainer says he's 'back to square one'", "description": "Children's entertainers say they are struggling with the new \"rule of six\" for social gatherings.", "link": "https://www.bbc.co.uk/news/uk-england-hampshire-54163131", "published": "Wed, 16 Sep 2020 00:55:21 GMT", "source": "BBC News - England"}, {"title": "Blind veteran writes cookery book for other visually-impaired people", "description": "Ex-Royal Marine Simon Mahoney says he hopes the book will help blind people to start cooking.", "link": "https://www.bbc.co.uk/news/uk-england-derbyshire-54118249", "published": "Mon, 14 Sep 2020 23:02:28 GMT", "source": "BBC News - England"}, {"title": "Seal joins in with River Witham paddleboard lesson", "description": "The seal hitched a ride on a paddleboard during a lesson on the River Witham in Lincolnshire.", "link": "https://www.bbc.co.uk/news/uk-england-lincolnshire-54153389", "published": "Mon, 14 Sep 2020 19:31:47 GMT", "source": "BBC News - England"}, {"title": "Bale set to arrive in England on Friday for Spurs return", "description": "Real Madrid forward Gareth Bale is set to fly to England on Friday to complete his return to Tottenham Hotspur.", "link": "https://www.bbc.co.uk/sport/football/54192248", "published": "Thu, 17 Sep 2020 11:22:31 GMT", "source": "BBC News - England"}, {"title": "Thiago Alcantara: Liverpool agree \u00a325m deal for Bayern Munich midfielder", "description": "Liverpool agree a deal to sign Spain midfielder Thiago Alcantara from Bayern Munich for at least \u00a320m, plus \u00a35m in add-ons.", "link": "https://www.bbc.co.uk/sport/football/54188430", "published": "Thu, 17 Sep 2020 12:01:52 GMT", "source": "BBC News - England"}, {"title": "Broad, Anderson, BLM, Cook and Vaughan - England's bio-secure summer", "description": "As England men's summer comes to a close, BBC Sport looks at the winners and losers from the unique time in the bio-secure bubbles.", "link": "https://www.bbc.co.uk/sport/cricket/54161887", "published": "Thu, 17 Sep 2020 06:36:28 GMT", "source": "BBC News - England"}, {"title": "EFL chairman Rick Parry says it is not inevitable football clubs will fold in the new year", "description": "EFL chairman Rick Parry says a financial solution is needed quickly to \"keep every single club alive\".", "link": "https://www.bbc.co.uk/sport/football/54188880", "published": "Thu, 17 Sep 2020 08:57:05 GMT", "source": "BBC News - England"}, {"title": "Six Rugby League and Rugby Union games allowed fans", "description": "Six matches from across both rugby codes are chosen to host up to 1,000 fans each as part of government crowd pilots.", "link": "https://www.bbc.co.uk/sport/rugby-league/54179892", "published": "Thu, 17 Sep 2020 09:40:01 GMT", "source": "BBC News - England"}, {"title": "The coronavirus rules we all need to follow - and the areas with tougher restrictions", "description": "Social gatherings of more than six people have been banned across Britain in an attempt to curb the rise in coronavirus cases - and tougher lockdown restrictions are being imposed in the worst-hit areas.", "link": "http://news.sky.com/story/coronavirus-new-rules-on-social-gatherings-in-england-heres-what-you-can-and-cant-do-12067349", "published": "Wed, 09 Sep 2020 13:02:00 +0100", "source": "UK News - The latest headlines from the UK | Sky News"}, {"title": "Weekly positive COVID-19 tests have doubled since Test and Trace was launched in May", "description": "The number of people testing positive for coronavirus in England is now double the number recorded when the country's Test and Trace system was launched at the end of May.", "link": "http://news.sky.com/story/coronavirus-positive-covid-19-tests-double-since-test-and-trace-launch-latest-figures-show-12073898", "published": "Thu, 17 Sep 2020 09:51:00 +0100", "source": "UK News - The latest headlines from the UK | Sky News"}, {"title": "North Yorkshire goes into 'full emergency mode' due to rise in cases", "description": "North Yorkshire's emergency services have gone into \"full emergency mode\" due to a rise in coronavirus cases and nationwide issues with testing capacity.", "link": "http://news.sky.com/story/coronavirus-north-yorkshire-goes-into-full-emergency-mode-due-to-rise-in-cases-12074023", "published": "Thu, 17 Sep 2020 11:59:00 +0100", "source": "UK News - The latest headlines from the UK | Sky News"}, {"title": "North East lockdown: 10pm curfew for bars and pubs and ban on household mixing", "description": "New local restrictions are being introduced in northeast England - including a 10pm curfew for bars and pubs and a ban on people mixing with others outside their household.", "link": "http://news.sky.com/story/coronavirus-curfews-for-bars-and-pubs-among-new-lockdown-restrictions-in-northeast-england-12073858", "published": "Thu, 17 Sep 2020 09:04:00 +0100", "source": "UK News - The latest headlines from the UK | Sky News"}, {"title": "Diversity's Black Lives Matter routine won't face investigation, watchdog says", "description": "Diversity's Black Lives Matter-inspired performance on Britain's Got Talent will not face investigation from media regulator Ofcom.", "link": "http://news.sky.com/story/britains-got-talent-diversitys-black-lives-matter-performance-wont-face-ofcom-investigation-12073999", "published": "Thu, 17 Sep 2020 11:41:00 +0100", "source": "UK News - The latest headlines from the UK | Sky News"}, {"title": "'Failing' Chris Grayling lands &#163;100,000 role with ports company", "description": "Former cabinet minister Chris Grayling - who once gave a multimillion-pound contract to a ferry firm with no ships - has landed a new &#163;275 per hour role with a major ports company.", "link": "http://news.sky.com/story/failing-chris-grayling-lands-163100000-role-with-ports-company-12073978", "published": "Thu, 17 Sep 2020 11:13:00 +0100", "source": "UK News - The latest headlines from the UK | Sky News"}, {"title": "BoE warns recent COVID-19 case increases could hold back economy", "description": "Britain's economy is \"less weak\" than previously expected but a recent rise in COVID-19 cases could take its toll on activity, the Bank of England has said.", "link": "http://news.sky.com/story/coronavirus-boe-warns-recent-case-increases-could-hold-back-economy-12074002", "published": "Thu, 17 Sep 2020 11:44:00 +0100", "source": "UK News - The latest headlines from the UK | Sky News"}, {"title": "Government dismisses claims of fresh two-week national lockdown", "description": "A government minister has dismissed suggestions the UK could be heading for a two-week national lockdown.", "link": "http://news.sky.com/story/coronavirus-government-dismisses-claims-of-fresh-two-week-national-lockdown-12073792", "published": "Thu, 17 Sep 2020 07:12:00 +0100", "source": "UK News - The latest headlines from the UK | Sky News"}, {"title": "PM says only report rule breakers if they are having 'Animal House' parties", "description": "Boris Johnson has said members of the public should not report neighbours who breach the \"rule of six\" unless they are having \"Animal House\" parties with \"hot tubs and so forth\".", "link": "http://news.sky.com/story/coronavirus-boris-johnson-says-only-report-rule-breakers-if-they-are-having-animal-house-parties-12073784", "published": "Thu, 17 Sep 2020 06:53:00 +0100", "source": "UK News - The latest headlines from the UK | Sky News"}, {"title": "Lonely pensioner who put poster in window asking for friends gets 'tsunami' of messages", "description": "A lonely pensioner who put a sign in his window asking for friends has been inundated with a \"tsunami\" of messages from well-wishers across the globe.", "link": "http://news.sky.com/story/lonely-pensioner-who-put-poster-in-window-asking-for-friends-gets-tsunami-of-messages-12073901", "published": "Thu, 17 Sep 2020 09:52:00 +0100", "source": "UK News - The latest headlines from the UK | Sky News"}, {"title": "Mother 'furious' at delay in notification of school Covid case", "description": "A mother is frustrated it took two days for parents to find out a student at their child's school tested positive for coronavirus.", "link": "https://www.rnz.co.nz/news/national/426321/mother-furious-at-delay-in-notification-of-school-covid-case", "published": "Thu, 17 Sep 2020 17:55:36 +1200", "source": "RNZ New Zealand Headlines"}, {"title": "MedSafe warns six sellers of 'weight loss' coffee product", "description": "Six sellers of a coffee powder marketed as a weight loss product have been told to close up shop or face prosecution.", "link": "https://www.rnz.co.nz/national/programmes/checkpoint/audio/2018764470/weight-loss-coffee-sellers-warned-of-prosecution-medsafe", "published": "Thu, 17 Sep 2020 18:36:05 +1200", "source": "RNZ New Zealand Headlines"}, {"title": "'Languishing' Jobs for Nature fund process leaves tourism operator fearful", "description": "A South Island tourism operator says he could have prevented redundancies if wasn't for delays to a nature-based job creation scheme.", "link": "https://www.rnz.co.nz/news/national/426327/languishing-jobs-for-nature-fund-process-leaves-tourism-operator-fearful", "published": "Thu, 17 Sep 2020 19:24:42 +1200", "source": "RNZ New Zealand Headlines"}, {"title": "Greater Wellington Regional Council considers Snapper bus card rollout on Metlink trains", "description": "Greater Wellington Regional Council says Covid-19 showed the need for safe contactless payment methods across the entire network sooner rather than later.", "link": "https://www.rnz.co.nz/news/national/426329/greater-wellington-regional-council-considers-snapper-bus-card-rollout-on-metlink-trains", "published": "Thu, 17 Sep 2020 19:38:00 +1200", "source": "RNZ New Zealand Headlines"}, {"title": "Dilworth School Board says convictions have resulted from previously reported sex abuse allegations", "description": "The school at the centre of an historical sex abuse investigation says it has previously reported allegations of sexual abuse to the police which have resulted in convictions.", "link": "https://www.rnz.co.nz/news/national/426296/dilworth-school-board-says-convictions-have-resulted-from-previously-reported-sex-abuse-allegations", "published": "Thu, 17 Sep 2020 15:44:52 +1200", "source": "RNZ New Zealand Headlines"}, {"title": "Seven new cases of Covid-19 today, all in managed isolation facilities", "description": "There are seven new cases of Covid-19 today, all in managed isolation facilities.", "link": "https://www.rnz.co.nz/news/national/426284/seven-new-cases-of-covid-19-today-all-in-managed-isolation-facilities", "published": "Thu, 17 Sep 2020 16:10:45 +1200", "source": "RNZ New Zealand Headlines"}, {"title": "Firefighters battle large fire on SH7 near Hanmer Springs", "description": "Fire and Emergency crews are fighting the fire near Mouse Point on State Highway 7.", "link": "https://www.rnz.co.nz/news/national/426319/firefighters-battle-large-fire-on-sh7-near-hanmer-springs", "published": "Thu, 17 Sep 2020 17:47:22 +1200", "source": "RNZ New Zealand Headlines"}, {"title": "Weta Digital commissions independent review", "description": "Weta Digital has commissioned a QC to do an independent review after recent complaints about harassment and bullying.", "link": "https://www.rnz.co.nz/news/national/426317/weta-digital-commissions-independent-review", "published": "Thu, 17 Sep 2020 17:42:23 +1200", "source": "RNZ New Zealand Headlines"}, {"title": "Britomart train station shuts after cracks found on tracks", "description": "KiwiRail says it knew of some faults near Britomart and was already planning to deal with them, but last night it found they needed immediate repairs.", "link": "https://www.rnz.co.nz/news/national/426300/britomart-train-station-shuts-after-cracks-found-on-tracks", "published": "Thu, 17 Sep 2020 16:08:36 +1200", "source": "RNZ New Zealand Headlines"}, {"title": "Person escaped managed isolation hotel in Rotorua", "description": "A man who left the managed isolation Sudima Hotel in Rotorua last night is believed to have fled through a fenced area.", "link": "https://www.rnz.co.nz/news/national/426277/person-escaped-managed-isolation-hotel-in-rotorua", "published": "Thu, 17 Sep 2020 12:17:09 +1200", "source": "RNZ New Zealand Headlines"}, {"title": "Police lay charges relating to cannabis oil production after Invercargill house explosion", "description": "Police have finally revealed an explosion and fire at a K\u0101inga Ora-owned Invercargill home last week was due to cannabis oil production.", "link": "https://www.rnz.co.nz/news/national/426303/police-lay-charges-relating-to-cannabis-oil-production-after-invercargill-house-explosion", "published": "Thu, 17 Sep 2020 16:35:58 +1200", "source": "RNZ New Zealand Headlines"}, {"title": "Fund to increase kiwi bird population to 100,000", "description": "Close to $20 million has been earmarked to aid plans to grow the kiwi bird population to 100,000 by 2030.", "link": "https://www.rnz.co.nz/news/national/426291/fund-to-increase-kiwi-bird-population-to-100-000", "published": "Thu, 17 Sep 2020 15:01:09 +1200", "source": "RNZ New Zealand Headlines"}, {"title": "Plans to open liquor store in Amberley opposed by scores of locals", "description": "A small North Canterbury town has turned out in droves to oppose the opening of a new liquor store.", "link": "https://www.rnz.co.nz/news/national/426304/plans-to-open-liquor-store-in-amberley-opposed-by-scores-of-locals", "published": "Thu, 17 Sep 2020 16:35:59 +1200", "source": "RNZ New Zealand Headlines"}, {"title": "Sunstrike might have caused Bunnythorpe school bus crash", "description": "The driver of a school bus who died after a crash at Bunnythorpe yesterday might have been blinded by sunstrike, says Uzabus managing director Justin Allan.", "link": "https://www.rnz.co.nz/news/national/426268/sunstrike-might-have-caused-bunnythorpe-school-bus-crash", "published": "Thu, 17 Sep 2020 10:32:15 +1200", "source": "RNZ New Zealand Headlines"}, {"title": "Police abused power after drug raid on Warkworth motel - IPCA", "description": "Police abused their power after a drug search of a Warkworth motel in 2016, says the Independent Police Conduct Authority.", "link": "https://www.rnz.co.nz/news/national/426289/police-abused-power-after-drug-raid-on-warkworth-motel-ipca", "published": "Thu, 17 Sep 2020 14:04:47 +1200", "source": "RNZ New Zealand Headlines"}, {"title": "Three egg companies allowed to be whisked together", "description": "The Commerce Commission has approved a three-way merger in the egg industry.", "link": "https://www.rnz.co.nz/news/national/426290/three-egg-companies-allowed-to-be-whisked-together", "published": "Thu, 17 Sep 2020 14:54:02 +1200", "source": "RNZ New Zealand Headlines"}, {"title": "'Escape, hide, tell' - police advice for attacks on crowds", "description": "Advice on what to do if a crowded place is attacked has been released by the police.", "link": "https://www.rnz.co.nz/news/national/426287/escape-hide-tell-police-advice-for-attacks-on-crowds", "published": "Thu, 17 Sep 2020 14:19:11 +1200", "source": "RNZ New Zealand Headlines"}, {"title": "Bid to give Gordon Wilson Flats heritage status", "description": "Two run-down Wellington social housing apartment blocks are being recommended for Category One Heritage listing.", "link": "https://www.rnz.co.nz/news/national/426275/bid-to-give-gordon-wilson-flats-heritage-status", "published": "Thu, 17 Sep 2020 12:05:46 +1200", "source": "RNZ New Zealand Headlines"}, {"title": "New Survey Results From KFF/Cook Political Report Survey in AZ, Fl, and NC. AZ Moves to Lean Dem (Amy Walter/The Cook Political Report)", "description": "<a href=\"https://cookpolitical.com/analysis/national/national-politics/new-survey-results-kffcook-political-report-survey-az-fl-and-nc\"><img align=\"RIGHT\" border=\"0\" hspace=\"4\" src=\"http://www.memeorandum.com/200917/i25.jpg\" vspace=\"4\" /></a>\n<p><a href=\"http://www.memeorandum.com/200917/p25#a200917p25\" title=\"memeorandum permalink\"><img height=\"12\" src=\"http://www.memeorandum.com/img/pml.png\" style=\"border: none; padding: 0; margin: 0;\" width=\"11\" /></a> Amy Walter / <a href=\"https://cookpolitical.com/\">The Cook Political Report</a>:<br />\n<span style=\"font-size: 1.3em;\"><b><a href=\"https://cookpolitical.com/analysis/national/national-politics/new-survey-results-kffcook-political-report-survey-az-fl-and-nc\">New Survey Results From KFF/Cook Political Report Survey in AZ, Fl, and NC.&nbsp; AZ Moves to Lean Dem</a></b></span>&nbsp; &mdash;&nbsp; There are two key geographic battlegrounds for the Electoral College this year.&nbsp; One is the Midwest that until 2016, had been reliably Democratic.&nbsp; The other is the fast-growing Sun Belt section &hellip; </p>", "link": "http://www.memeorandum.com/200917/p25#a200917p25", "published": "Thu, 17 Sep 2020 08:50:00 -0400", "source": "memeorandum"}, {"title": "Chad Wolf appears ready to defy House subpoena to testify, DHS official says (CNN)", "description": "<a href=\"https://cnn.com/2020/09/16/politics/chad-wolf-defy-house-subpoena-dhs/\"><img align=\"RIGHT\" border=\"0\" hspace=\"4\" src=\"http://www.memeorandum.com/200917/i26.jpg\" vspace=\"4\" /></a>\n<p><a href=\"http://www.memeorandum.com/200917/p26#a200917p26\" title=\"memeorandum permalink\"><img height=\"12\" src=\"http://www.memeorandum.com/img/pml.png\" style=\"border: none; padding: 0; margin: 0;\" width=\"11\" /></a> <a href=\"http://www.cnn.com/\">CNN</a>:<br />\n<span style=\"font-size: 1.3em;\"><b><a href=\"https://cnn.com/2020/09/16/politics/chad-wolf-defy-house-subpoena-dhs/\">Chad Wolf appears ready to defy House subpoena to testify, DHS official says</a></b></span>&nbsp; &mdash;&nbsp; Acting Secy Wolf: DHS needs a confirmed secretary&nbsp; &mdash;&nbsp; (CNN)Acting Homeland Security Secretary Chad Wolf appears ready to defy a House subpoena issued last week for him to testify Thursday on threats to the US homeland &hellip; </p>", "link": "http://www.memeorandum.com/200917/p26#a200917p26", "published": "Thu, 17 Sep 2020 08:50:00 -0400", "source": "memeorandum"}, {"title": "The Higher Wages of Growth (Wall Street Journal)", "description": "<a href=\"https://www.wsj.com/articles/the-higher-wages-of-growth-11600298577?mod=djemalertNEWS\"><img align=\"RIGHT\" border=\"0\" hspace=\"4\" src=\"http://www.memeorandum.com/200917/i24.jpg\" vspace=\"4\" /></a>\n<p><a href=\"http://www.memeorandum.com/200917/p24#a200917p24\" title=\"memeorandum permalink\"><img height=\"12\" src=\"http://www.memeorandum.com/img/pml.png\" style=\"border: none; padding: 0; margin: 0;\" width=\"11\" /></a> <a href=\"https://www.wsj.com/\">Wall Street Journal</a>:<br />\n<span style=\"font-size: 1.3em;\"><b><a href=\"https://www.wsj.com/articles/the-higher-wages-of-growth-11600298577?mod=djemalertNEWS\">The Higher Wages of Growth</a></b></span>&nbsp; &mdash;&nbsp; Before the pandemic, income growth soared and poverty fell to the lowest rate since 1959.&nbsp; &mdash;&nbsp; By The Editorial Board&nbsp; &mdash;&nbsp; In case you missed it, and most of the media did, the Census Bureau reported Tuesday that the median household income in 2019 grew a whopping 6.8% &hellip; </p>", "link": "http://www.memeorandum.com/200917/p24#a200917p24", "published": "Thu, 17 Sep 2020 08:35:02 -0400", "source": "memeorandum"}, {"title": "Dems fear Wisconsin governor is becoming a liability for Biden (Natasha Korecki/Politico)", "description": "<a href=\"https://www.politico.com/news/2020/09/17/tony-evers-kenosha-wisconsin-415706\"><img align=\"RIGHT\" border=\"0\" hspace=\"4\" src=\"http://www.memeorandum.com/200917/i23.jpg\" vspace=\"4\" /></a>\n<p><a href=\"http://www.memeorandum.com/200917/p23#a200917p23\" title=\"memeorandum permalink\"><img height=\"12\" src=\"http://www.memeorandum.com/img/pml.png\" style=\"border: none; padding: 0; margin: 0;\" width=\"11\" /></a> Natasha Korecki / <a href=\"http://www.politico.com/\">Politico</a>:<br />\n<span style=\"font-size: 1.3em;\"><b><a href=\"https://www.politico.com/news/2020/09/17/tony-evers-kenosha-wisconsin-415706\">Dems fear Wisconsin governor is becoming a liability for Biden</a></b></span>&nbsp; &mdash;&nbsp; KENOSHA, Wis. &mdash; Tony Evers pulled off one of the Democratic Party's biggest feats of 2018: ousting liberal villain Scott Walker after earlier attempts to take out the Wisconsin governor fell short.</p>", "link": "http://www.memeorandum.com/200917/p23#a200917p23", "published": "Thu, 17 Sep 2020 08:30:00 -0400", "source": "memeorandum"}, {"title": "Stanley Crouch, Towering Jazz Critic, Dead At 74 (Ethan Iverson/NPR)", "description": "<a href=\"https://www.npr.org/2020/09/16/913619163/stanley-crouch-towering-jazz-critic-dead-at-74\"><img align=\"RIGHT\" border=\"0\" hspace=\"4\" src=\"http://www.memeorandum.com/200917/i22.jpg\" vspace=\"4\" /></a>\n<p><a href=\"http://www.memeorandum.com/200917/p22#a200917p22\" title=\"memeorandum permalink\"><img height=\"12\" src=\"http://www.memeorandum.com/img/pml.png\" style=\"border: none; padding: 0; margin: 0;\" width=\"11\" /></a> Ethan Iverson / <a href=\"http://www.npr.org/\">NPR</a>:<br />\n<span style=\"font-size: 1.3em;\"><b><a href=\"https://www.npr.org/2020/09/16/913619163/stanley-crouch-towering-jazz-critic-dead-at-74\">Stanley Crouch, Towering Jazz Critic, Dead At 74</a></b></span>&nbsp; &mdash;&nbsp; Stanley Crouch, the lauded and fiery jazz critic, has died.&nbsp; According to an announcement by his wife, Gloria Nixon-Crouch, Stanley Crouch died at the Calvary Hospital in New York on Wednesday , following nearly a decade of serious health issues.</p>", "link": "http://www.memeorandum.com/200917/p22#a200917p22", "published": "Thu, 17 Sep 2020 08:25:02 -0400", "source": "memeorandum"}, {"title": "Navalny team says nerve agent was found on hotel room water bottle (Reuters)", "description": "<a href=\"https://www.reuters.com/article/us-russia-politics-navalny-idUSKBN2680X0\"><img align=\"RIGHT\" border=\"0\" hspace=\"4\" src=\"http://www.memeorandum.com/200917/i21.jpg\" vspace=\"4\" /></a>\n<p><a href=\"http://www.memeorandum.com/200917/p21#a200917p21\" title=\"memeorandum permalink\"><img height=\"12\" src=\"http://www.memeorandum.com/img/pml.png\" style=\"border: none; padding: 0; margin: 0;\" width=\"11\" /></a> <a href=\"http://www.reuters.com/\">Reuters</a>:<br />\n<span style=\"font-size: 1.3em;\"><b><a href=\"https://www.reuters.com/article/us-russia-politics-navalny-idUSKBN2680X0\">Navalny team says nerve agent was found on hotel room water bottle</a></b></span>&nbsp; &mdash;&nbsp; MOSCOW (Reuters) - The nerve agent used to poison Russian opposition leader Alexei Navalny was detected on an empty water bottle from his hotel room in the Siberian city of Tomsk, suggesting he was poisoned &hellip; </p>", "link": "http://www.memeorandum.com/200917/p21#a200917p21", "published": "Thu, 17 Sep 2020 08:20:03 -0400", "source": "memeorandum"}, {"title": "U.S. Intel Repeatedly Warned About Rudy's 'Russian Agent' Pal (The Daily Beast)", "description": "<a href=\"https://www.thedailybeast.com/us-intel-repeatedly-warned-about-andriy-derkach-rudy-giulianis-russian-agent-pal?scrolla=5eb6d68b7fedc32c19ef33b4\"><img align=\"RIGHT\" border=\"0\" hspace=\"4\" src=\"http://www.memeorandum.com/200917/i17.jpg\" vspace=\"4\" /></a>\n<p><a href=\"http://www.memeorandum.com/200917/p17#a200917p17\" title=\"memeorandum permalink\"><img height=\"12\" src=\"http://www.memeorandum.com/img/pml.png\" style=\"border: none; padding: 0; margin: 0;\" width=\"11\" /></a> <a href=\"https://www.thedailybeast.com/\">The Daily Beast</a>:<br />\n<span style=\"font-size: 1.3em;\"><b><a href=\"https://www.thedailybeast.com/us-intel-repeatedly-warned-about-andriy-derkach-rudy-giulianis-russian-agent-pal?scrolla=5eb6d68b7fedc32c19ef33b4\">U.S. Intel Repeatedly Warned About Rudy's &lsquo;Russian Agent&rsquo; Pal</a></b></span>&nbsp; &mdash;&nbsp; RED ALERT&nbsp; &mdash;&nbsp; For a year and a half, U.S. intelligence warned that Andriy Derkach was suspected of election interference.&nbsp; Yet Derkach&mdash;and his wild beliefs&mdash;kept drawing more Trumpist adherents.</p>", "link": "http://www.memeorandum.com/200917/p17#a200917p17", "published": "Thu, 17 Sep 2020 08:15:00 -0400", "source": "memeorandum"}, {"title": "The One Vital Message Democrats Need to Win (Politico)", "description": "<a href=\"https://www.politico.com/news/magazine/2020/09/17/democrats-need-to-win-working-class-416211\"><img align=\"RIGHT\" border=\"0\" hspace=\"4\" src=\"http://www.memeorandum.com/200917/i20.jpg\" vspace=\"4\" /></a>\n<p><a href=\"http://www.memeorandum.com/200917/p20#a200917p20\" title=\"memeorandum permalink\"><img height=\"12\" src=\"http://www.memeorandum.com/img/pml.png\" style=\"border: none; padding: 0; margin: 0;\" width=\"11\" /></a> <a href=\"http://www.politico.com/\">Politico</a>:<br />\n<span style=\"font-size: 1.3em;\"><b><a href=\"https://www.politico.com/news/magazine/2020/09/17/democrats-need-to-win-working-class-416211\">The One Vital Message Democrats Need to Win</a></b></span>&nbsp; &mdash;&nbsp; The most powerful campaign message the Democrats have been sending in 2020&mdash;exemplified by their diverse, stirring lineup of convention speeches&mdash;is an appeal to inclusion and identity.&nbsp; The party clearly is making a clear effort, in particular &hellip; </p>", "link": "http://www.memeorandum.com/200917/p20#a200917p20", "published": "Thu, 17 Sep 2020 08:15:00 -0400", "source": "memeorandum"}, {"title": "Inside Trump's crazy quilt reelection map (David Siders/Politico)", "description": "<a href=\"https://www.politico.com/news/2020/09/16/trump-election-battleground-map-412726\"><img align=\"RIGHT\" border=\"0\" hspace=\"4\" src=\"http://www.memeorandum.com/200917/i19.jpg\" vspace=\"4\" /></a>\n<p><a href=\"http://www.memeorandum.com/200917/p19#a200917p19\" title=\"memeorandum permalink\"><img height=\"12\" src=\"http://www.memeorandum.com/img/pml.png\" style=\"border: none; padding: 0; margin: 0;\" width=\"11\" /></a> David Siders / <a href=\"http://www.politico.com/\">Politico</a>:<br />\n<span style=\"font-size: 1.3em;\"><b><a href=\"https://www.politico.com/news/2020/09/16/trump-election-battleground-map-412726\">Inside Trump's crazy quilt reelection map</a></b></span>&nbsp; &mdash;&nbsp; Donald Trump is scrambling his defenses in states like Ohio and Iowa, where he was once expected to win easily.&nbsp; Yet he's also competing hard in others, such as Minnesota and Nevada, that were once viewed as far out of his reach.</p>", "link": "http://www.memeorandum.com/200917/p19#a200917p19", "published": "Thu, 17 Sep 2020 08:15:00 -0400", "source": "memeorandum"}, {"title": "Biden believes he would have authority to impose national mask mandate as president (Grace Segers/CBS News)", "description": "<a href=\"https://www.cbsnews.com/news/biden-mask-mandate-president/\"><img align=\"RIGHT\" border=\"0\" hspace=\"4\" src=\"http://www.memeorandum.com/200917/i18.jpg\" vspace=\"4\" /></a>\n<p><a href=\"http://www.memeorandum.com/200917/p18#a200917p18\" title=\"memeorandum permalink\"><img height=\"12\" src=\"http://www.memeorandum.com/img/pml.png\" style=\"border: none; padding: 0; margin: 0;\" width=\"11\" /></a> Grace Segers / <a href=\"http://www.cbsnews.com/\">CBS News</a>:<br />\n<span style=\"font-size: 1.3em;\"><b><a href=\"https://www.cbsnews.com/news/biden-mask-mandate-president/\">Biden believes he would have authority to impose national mask mandate as president</a></b></span>&nbsp; &mdash;&nbsp; Democratic presidential nominee Joe Biden said that he believes he would have the legal authority to impose a nationwide mask mandate to slow the spread of coronavirus if elected president &hellip; </p>", "link": "http://www.memeorandum.com/200917/p18#a200917p18", "published": "Thu, 17 Sep 2020 08:15:00 -0400", "source": "memeorandum"}, {"title": "A scrapped plan to ship masks to Americans. A standoff with Amazon amid pressure from Trump. New documents detail USPS's spring in crisis. (Washington Post)", "description": "<a href=\"https://www.washingtonpost.com/us-policy/2020/09/17/usps-trump-coronavirus-amazon-foia/\"><img align=\"RIGHT\" border=\"0\" hspace=\"4\" src=\"http://www.memeorandum.com/200917/i14.jpg\" vspace=\"4\" /></a>\n<p><a href=\"http://www.memeorandum.com/200917/p14#a200917p14\" title=\"memeorandum permalink\"><img height=\"12\" src=\"http://www.memeorandum.com/img/pml.png\" style=\"border: none; padding: 0; margin: 0;\" width=\"11\" /></a> <a href=\"https://www.washingtonpost.com/\">Washington Post</a>:<br />\n<span style=\"font-size: 1.3em;\"><b><a href=\"https://www.washingtonpost.com/us-policy/2020/09/17/usps-trump-coronavirus-amazon-foia/\">A scrapped plan to ship masks to Americans.&nbsp; A standoff with Amazon amid pressure from Trump.&nbsp; New documents detail USPS's spring in crisis.</a></b></span>&nbsp; &mdash;&nbsp; Nearly 10,000 pages of emails, memos and other private documents offer new details about the agency's struggles and the pro-Trump figures to whom it turned for advice</p>", "link": "http://www.memeorandum.com/200917/p14#a200917p14", "published": "Thu, 17 Sep 2020 08:05:13 -0400", "source": "memeorandum"}, {"title": "DeJoy's Postal Service policies delayed 7 percent of nation's first-class mail, Senate Democrat's report says (Jacob Bogage/Washington Post)", "description": "<a href=\"https://www.washingtonpost.com/business/2020/09/16/dejoy-usps-delays-senate-report/\"><img align=\"RIGHT\" border=\"0\" hspace=\"4\" src=\"http://www.memeorandum.com/200917/i15.jpg\" vspace=\"4\" /></a>\n<p><a href=\"http://www.memeorandum.com/200917/p15#a200917p15\" title=\"memeorandum permalink\"><img height=\"12\" src=\"http://www.memeorandum.com/img/pml.png\" style=\"border: none; padding: 0; margin: 0;\" width=\"11\" /></a> Jacob Bogage / <a href=\"https://www.washingtonpost.com/\">Washington Post</a>:<br />\n<span style=\"font-size: 1.3em;\"><b><a href=\"https://www.washingtonpost.com/business/2020/09/16/dejoy-usps-delays-senate-report/\">DeJoy's Postal Service policies delayed 7 percent of nation's first-class mail, Senate Democrat's report says</a></b></span>&nbsp; &mdash;&nbsp; The postmaster general suspended some cost-cutting maneuvers but not the moves experts say are behind the worst problems&nbsp; &mdash;&nbsp; Postmaster General Louis DeJoy's controversial &hellip; </p>", "link": "http://www.memeorandum.com/200917/p15#a200917p15", "published": "Thu, 17 Sep 2020 08:05:13 -0400", "source": "memeorandum"}, {"title": "GOP growing more indifferent with Trump controversies as election nears (CNN)", "description": "<a href=\"https://cnn.com/2020/09/17/politics/republican-reaction-trump-controversies/\"><img align=\"RIGHT\" border=\"0\" hspace=\"4\" src=\"http://www.memeorandum.com/200917/i16.jpg\" vspace=\"4\" /></a>\n<p><a href=\"http://www.memeorandum.com/200917/p16#a200917p16\" title=\"memeorandum permalink\"><img height=\"12\" src=\"http://www.memeorandum.com/img/pml.png\" style=\"border: none; padding: 0; margin: 0;\" width=\"11\" /></a> <a href=\"http://www.cnn.com/\">CNN</a>:<br />\n<span style=\"font-size: 1.3em;\"><b><a href=\"https://cnn.com/2020/09/17/politics/republican-reaction-trump-controversies/\">GOP growing more indifferent with Trump controversies as election nears</a></b></span>&nbsp; &mdash;&nbsp; Washington (CNN)Public health experts reacted with alarm after President Donald Trump held an indoor rally with thousands of maskless supporters at a packed arena in Nevada amid the deadly coronavirus pandemic.</p>", "link": "http://www.memeorandum.com/200917/p16#a200917p16", "published": "Thu, 17 Sep 2020 08:05:13 -0400", "source": "memeorandum"}, {"title": "Barack Obama to release first volume of memoirs after election (Axios)", "description": "<a href=\"https://www.axios.com/barack-obama-book-a-promised-land-memoir-052d42e4-827a-4aad-b0ba-6605f315a28e.html\"><img align=\"RIGHT\" border=\"0\" hspace=\"4\" src=\"http://www.memeorandum.com/200917/i13.jpg\" vspace=\"4\" /></a>\n<p><a href=\"http://www.memeorandum.com/200917/p13#a200917p13\" title=\"memeorandum permalink\"><img height=\"12\" src=\"http://www.memeorandum.com/img/pml.png\" style=\"border: none; padding: 0; margin: 0;\" width=\"11\" /></a> <a href=\"https://www.axios.com/politics-policy\">Axios</a>:<br />\n<span style=\"font-size: 1.3em;\"><b><a href=\"https://www.axios.com/barack-obama-book-a-promised-land-memoir-052d42e4-827a-4aad-b0ba-6605f315a28e.html\">Barack Obama to release first volume of memoirs after election</a></b></span>&nbsp; &mdash;&nbsp; Former President Obama's memoir will be published in two volumes &mdash; with a 768-page Volume 1, &ldquo;A Promised Land,&rdquo; out Nov. 17 in 25 languages, publisher Penguin Random House announced Thursday.</p>", "link": "http://www.memeorandum.com/200917/p13#a200917p13", "published": "Thu, 17 Sep 2020 07:45:18 -0400", "source": "memeorandum"}, {"title": "Trump shattered his promise to 'drain the swamp.' The self-dealing would be epic in a second term. (Washington Post)", "description": "<a href=\"https://www.washingtonpost.com/opinions/2020/09/16/trump-promised-to-drain-swamp-self-dealing/\"><img align=\"RIGHT\" border=\"0\" hspace=\"4\" src=\"http://www.memeorandum.com/200917/i12.jpg\" vspace=\"4\" /></a>\n<p><a href=\"http://www.memeorandum.com/200917/p12#a200917p12\" title=\"memeorandum permalink\"><img height=\"12\" src=\"http://www.memeorandum.com/img/pml.png\" style=\"border: none; padding: 0; margin: 0;\" width=\"11\" /></a> <a href=\"https://www.washingtonpost.com/\">Washington Post</a>:<br />\n<span style=\"font-size: 1.3em;\"><b><a href=\"https://www.washingtonpost.com/opinions/2020/09/16/trump-promised-to-drain-swamp-self-dealing/\">Trump shattered his promise to &lsquo;drain the swamp.&rsquo; The self-dealing would be epic in a second term.</a></b></span>&nbsp; &mdash;&nbsp; &ldquo;Drain the swamp&rdquo; was a signature promise of Donald Trump's first campaign: He would uproot corruption from the capital and install a government that served ordinary Americans, not the special interests.</p>", "link": "http://www.memeorandum.com/200917/p12#a200917p12", "published": "Thu, 17 Sep 2020 07:30:08 -0400", "source": "memeorandum"}]
"""


def get_uuid(request) -> str:
    """
    Primitive method for generating a unique user identifier. I'll make a cookie based one too
    + Doesn't require cookies (or cookie notice)
    - Thinks it's a new user if you change your browser, or ip
    :param request:
    :return:
    """
    return hashlib.md5(bytes(request.remote_addr + request.headers.get('User-Agent'), "utf-8")).hexdigest()


if __name__ == "__main__":
    start_new_thread(start_scraper, ())
    app.run(host="localhost", port="80")
